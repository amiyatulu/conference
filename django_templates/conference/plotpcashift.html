<!DOCTYPE HTML>
<html>
  <head>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v5.0.2.min.js"></script>
    <script defer="defer">
    var kb1000 = {{kb1000|safe}};
      var stage = new Kinetic.Stage({
        container: 'container',
        width: (kb1000.length)*100,
        height: 250
      });
      var kb500 = {{kb500|safe}};
      var kb250 = {{kb250|safe}};
      var kb100 = {{kb100|safe }};
      var kb50 = {{kb50|safe}};
      var layer = new Kinetic.Layer();
      var rectan = [];
      var rect500 = [];
      var rect250 = [];
      var rect100 = [];
      var rect50 = [];

  


      for (i =0; i< kb1000.length; i++){
        if (kb1000[i] == 1) {
          color = 'red';
        } else {
           color = 'green';
        }

      rectan[i] = new Kinetic.Rect({
        x: 0 + i*100,
        y: 250 ,
        width: 100,
        height: 50,
        fill: color,
        stroke: 'black',
        strokeWidth: 0.5

      });

      layer.add(rectan[i]);
      }


      for (i =0; i< kb500.length; i++){
        if (kb500[i] == 1) {
          color = 'red';
        } else {
           color = 'green';
        }

      rect500[i] = new Kinetic.Rect({
        x: 0 + i*50,
        y: 200 ,
        width: 50,
        height: 50,
        fill: color,
        stroke: 'black',
        strokeWidth: 0.5

      });

      layer.add(rect500[i]);
      }


    for (i =0; i< kb250.length; i++){
        if (kb250[i] == 1) {
          color = 'red';
        } else {
           color = 'green';
        }

      rect250[i] = new Kinetic.Rect({
        x: 0 + i*25,
        y: 150 ,
        width: 25,
        height: 50,
        fill: color,
        stroke: 'black',
        strokeWidth: 0.5

      });

      layer.add(rect250[i]);
      }


      for (i =0; i< kb100.length; i++){
        if (kb100[i] == 1) {
          color = 'red';
        } else {
           color = 'green';
        }

      rect100[i] = new Kinetic.Rect({
        x: 0 + i*10,
        y: 100 ,
        width: 10,
        height: 50,
        fill: color,
        stroke: 'black',
        strokeWidth: 0.5

      });

      layer.add(rect100[i]);
      }



      for (i =0; i< kb50.length; i++){
          if (kb50[i] == 1) {
            color = 'red';
          } else {
             color = 'green';
          }

        rect50[i] = new Kinetic.Rect({
          x: 0 + i*5,
          y: 50 ,
          width: 10,
          height: 50,
          fill: color,
          stroke: 'black',
          strokeWidth: 0.5

        });

        layer.add(rect50[i]);
        }



      stage.add(layer);
      var myDataUrl;  //place outside of scope of function for saving
      stage.toDataURL({
          callback: function(dataUrl){
            // do something with the data url
            // like window.open(dataUrl); 
            // you can do anything do anything really, like
            myDataUrl = dataUrl;

            var img= new Image(); //or document.createElement('img');
            img.src= myDataUrl; 

            //(new Image()).src = "myDataUrl"; //or the shortcut way

            document.getElementById('container').appendChild(img);
          },
          mimeType: 'image/jpeg',
          quality: 0.5
      });
    </script>
  </body>
</html>